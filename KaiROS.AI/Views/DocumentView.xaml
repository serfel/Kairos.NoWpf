<UserControl x:Class="KaiROS.AI.Views.DocumentView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:converters="clr-namespace:KaiROS.AI.Converters">
    
    <UserControl.Resources>
        <converters:BoolToVisibilityConverter x:Key="BoolToVis"/>
    </UserControl.Resources>
    
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- Header -->
        <Border Background="{StaticResource CardBrush}" 
                CornerRadius="12" 
                Padding="20"
                Margin="0,0,0,16">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <StackPanel>
                    <TextBlock Text="ðŸ“„ Document Chat" 
                               FontSize="24" 
                               FontWeight="Bold" 
                               Foreground="{StaticResource TextPrimaryBrush}"/>
                    <TextBlock Text="Upload documents and chat with their content" 
                               Foreground="{StaticResource TextSecondaryBrush}"
                               Margin="0,4,0,0"/>
                </StackPanel>
                
                <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Top">
                    <Button Content="ðŸ“ Load Document" 
                            Command="{Binding LoadDocumentCommand}"
                            Style="{StaticResource AccentButton}"
                            Margin="0,0,8,0"/>
                    <Button Content="ðŸ—‘ Clear All" 
                            Command="{Binding ClearAllCommand}"
                            Style="{StaticResource SecondaryButton}"/>
                </StackPanel>
                
                <TextBlock Grid.Row="1" Grid.ColumnSpan="2"
                           Text="{Binding StatusMessage}" 
                           Foreground="{StaticResource TextMutedBrush}"
                           FontSize="12"
                           Margin="0,12,0,0"/>
            </Grid>
        </Border>
        
        <!-- Documents List -->
        <Border Grid.Row="1" 
                Background="{StaticResource CardBrush}" 
                CornerRadius="12" 
                Padding="16">
            <Grid>
                <!-- Empty State -->
                <StackPanel HorizontalAlignment="Center" 
                            VerticalAlignment="Center"
                            Visibility="{Binding Documents.Count, Converter={StaticResource BoolToVis}, ConverterParameter=Inverse}">
                    <TextBlock Text="ðŸ“‚" FontSize="48" HorizontalAlignment="Center" Margin="0,0,0,16"/>
                    <TextBlock Text="No documents loaded" 
                               FontSize="18" 
                               Foreground="{StaticResource TextSecondaryBrush}"
                               HorizontalAlignment="Center"/>
                    <TextBlock Text="Click 'Load Document' to upload TXT, DOCX, or MD files" 
                               Foreground="{StaticResource TextMutedBrush}"
                               HorizontalAlignment="Center"
                               Margin="0,8,0,0"/>
                </StackPanel>
                
                <!-- Documents -->
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <ItemsControl ItemsSource="{Binding Documents}">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Border Background="{StaticResource SurfaceLightBrush}" 
                                        CornerRadius="8" 
                                        Padding="16" 
                                        Margin="0,0,0,8">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        
                                        <!-- Icon -->
                                        <Border Background="{StaticResource PrimaryBrush}" 
                                                CornerRadius="8" 
                                                Width="44" 
                                                Height="44"
                                                Margin="0,0,16,0">
                                            <TextBlock Text="ðŸ“„" 
                                                       FontSize="24" 
                                                       HorizontalAlignment="Center" 
                                                       VerticalAlignment="Center"/>
                                        </Border>
                                        
                                        <!-- Info -->
                                        <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                            <TextBlock Text="{Binding FileName}" 
                                                       FontWeight="SemiBold"
                                                       FontSize="14"
                                                       Foreground="{StaticResource TextPrimaryBrush}"/>
                                            <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                                                <TextBlock Foreground="{StaticResource TextMutedBrush}" FontSize="12">
                                                    <Run Text="{Binding FileSizeText, Mode=OneWay}"/>
                                                    <Run Text=" â€¢ "/>
                                                    <Run Text="{Binding Chunks.Count, Mode=OneWay}"/>
                                                    <Run Text=" chunks"/>
                                                </TextBlock>
                                            </StackPanel>
                                        </StackPanel>
                                        
                                        <!-- Remove Button -->
                                        <Button Grid.Column="2" 
                                                Content="âœ•" 
                                                Style="{StaticResource IconButton}"
                                                Command="{Binding DataContext.RemoveDocumentCommand, RelativeSource={RelativeSource AncestorType=ItemsControl}}"
                                                CommandParameter="{Binding}"
                                                VerticalAlignment="Center"
                                                ToolTip="Remove document"/>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </ScrollViewer>
                
                <!-- Loading Overlay -->
                <Border Background="#80000000" 
                        CornerRadius="12"
                        Visibility="{Binding IsLoading, Converter={StaticResource BoolToVis}}">
                    <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                        <TextBlock Text="Loading document..." 
                                   Foreground="White" 
                                   FontSize="16"/>
                    </StackPanel>
                </Border>
            </Grid>
        </Border>
        
        <!-- Info Footer -->
        <Border Grid.Row="2" 
                Background="{StaticResource SurfaceBrush}" 
                CornerRadius="8" 
                Padding="16"
                Margin="0,16,0,0">
            <StackPanel>
                <TextBlock Text="ðŸ’¡ How it works" 
                           FontWeight="SemiBold" 
                           Foreground="{StaticResource TextPrimaryBrush}"
                           Margin="0,0,0,8"/>
                <TextBlock TextWrapping="Wrap" Foreground="{StaticResource TextSecondaryBrush}" FontSize="13">
                    <Run Text="1. Load documents (TXT, DOCX, MD)"/>
                    <LineBreak/>
                    <Run Text="2. Go to Chat and ask questions"/>
                    <LineBreak/>
                    <Run Text="3. The AI will use document content to answer"/>
                </TextBlock>
            </StackPanel>
        </Border>
    </Grid>
</UserControl>
